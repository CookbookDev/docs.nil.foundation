# Accounts

## Definition

In =nil;, an account is the minimal unit of data for sharding. An account consists of an address, its balance, its storage root and the hash of its source code.

Each execution shard handles only a dedicated part of all accounts in the global state of the cluster.

Accounts are distributed among shards using the following deterministic function.

$$
F_s : (pk, M_{shards})\to id_{shard}
$$

, where $pk$ is the public key of an account and $M_{shards}$ is the history and metadata of each execution shard.

## Security and rollbacks

In the case of a malicious node initiating an attack, the validator committee for the affected shard must initiate a rollback of all affected accounts.

This means that the corrupted accounts must be 'reset' to their last verified state.

There exist two possible methods for rolling back accounts.

* The 'carpet' method where the entire state is reset to the last previous valid state
* The 'surgical' method where only the corrupted accounts are rolled back

=nil; employs the 'carpet' method: during a rollback, all accounts are reset to their previous valid states regardless of whether they were affected by the attack.

:::tip[Justification]

Rolling back all accounts might seem excessive.

However, attacks propagate faster than state transition proofs are generated. While the cluster is figuring out what accounts to roll back, the attack might grow in size, making the 'surgical' method costly and risky. 

This makes the 'carpet' method more preferable despite its limitations.

:::