import Tabs from '@theme/Tabs'
import TabItem from '@theme/TabItem'

# Compiling a circuit

This tutorial contains step-by-step instructions on how to compile the [**arithmetic circuit created previously**](./writing-a-simple-circuit).

There are two possible ways for transforming a circuit into a proof binary and Solidity code.

- By calling individual tools
- By using [**the zkllvm-template project**](https://github.com/NilFoundation/zkllvm-template)

## Calling individual tools

The following diagram shows how individual tools interact when

- The C++ or the Rust compiler
- `assigner`
- `transpiler` (a tool for converting the circuit IR into a proof binary and Solidity code for deployment)

### Running the compiler

To generate the circuit IR, do the following.

<Tabs groupId='language'>
  <TabItem value='cpp' label='C++'>

    For a pre-built binary installation of `clang`:

    ```bash
    clang-zkllvm -S -emit-llvm  path/to/circuit.cpp
    ```

    For a `clang` installation from sources:

    ```bash
    $CLANG_ZKLLVM -S -emit-llvm  path/to/circuit.cpp
    ```

    , where `$CLANG_ZKLLVM` is the `clang` binary built during the installation.

  </TabItem>

  <TabItem value='rust' label='Rust'>

    For a pre-built binary installation of `rustc` and `cargo`:

    ```bash
    rustc +zkllvm --target assigner-unknown-unknown --emit=llvm-ir -o ./circuit.ll circuit.rs
    ```

    ```bash
    cargo +zkllvm build --target assigner-unknown-unknown
    ```

  </TabItem>
</Tabs>

### Passing the IR to `assigner`

At this stage, the newly generated IR and the public info file are ready to be passed to `assigner`.

Run the following command to generate the circuit constraints and the assignment table.

```bash
assigner -b circuit.ll -i ../inputs/public_input.inp -c circuit.crct -t assignment.tbl -e pallas --generate-type circuit-assignment
```

### Using `transpiler` to generate the circuit proof

The `.crct` and `.tbl` files can be passed to the `transpiler` tool to generate a binary with the proof and Solidity files containing the circuit.

Run the below command to generate `proof.bin`.

```bash
transpiler -m gen-test-proof -c circuit.crct -t assignment.tbl -o output -e pallas
```

Execute the following command to produce Solidity files.

```bash
transpiler -m gen-evm-verifier -c circuit.crct -t assignment.tbl -o output -e pallas --optimize-gates
```

Congratulations! At this stage, we recommend taking a look at other examples in the zkLLVM repository and compiling them.

## Using `zkllvm-template`

[**`zkllvm-template` is a project**](https://github.com/NilFoundation/zkllvm-template) designed to simplify working with complex circuits and zk-enabled apps.

To work with `zkllvm-template`, clone its repository with all sub-modules.

```bash
git clone --recurse-submodules https://github.com/NilFoundation/zkllvm-template.git
cd zkllvm-template
```

Additionally, [**install all required tools**](./installation).

Within `zkllvm-template`, the `./main` folder 
